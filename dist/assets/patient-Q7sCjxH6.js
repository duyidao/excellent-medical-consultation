import{M}from"./MySvgIcon-5cvDMJXN.js";import{M as x,n as q,i as A}from"./index-2B8i8twh.js";import{d as R,o as s,c as d,F as N,g as P,A as E,B as G,t as b,_ as U,e as g,i as H,q as J,r as p,a as o,f as l,C as w,w as v,u as S,h as K,b as O,s as Q,v as W}from"./index-zhWR9-Ye.js";import{a as X,e as Y,b as Z,d as ee}from"./user-AWwG0ggx.js";import{a as y}from"./index-5hrCnXoF.js";import{a as I}from"./function-call-SrH8P8GI.js";const ae={class:"cp-radio-btn"},te=["onClick"],oe=R({__name:"MyRadioBtn",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(m,{emit:_}){const f=_,h=i=>{f("update:modelValue",i)};return(i,r)=>(s(),d("div",ae,[(s(!0),d(N,null,P(i.options,u=>(s(),d("a",{key:u.value,class:E(["item",{active:i.modelValue===u.value}]),href:"javascript:;",onClick:G(e=>h(u.value),["stop"])},b(u.label),11,te))),128))]))}}),le=U(oe,[["__scopeId","data-v-d9c03c11"]]),D=m=>(Q("data-v-0fb565a1"),m=m(),W(),m),se={class:"patient-page"},ne={class:"patient-list"},de={class:"info"},ie={class:"name"},ue={class:"id"},re=["onClick"],ce={key:0,class:"tag"},pe=D(()=>l("p",null,"添加患者",-1)),ve=D(()=>l("div",{class:"patient-tip"},"最多可添加 6 人",-1)),me=R({__name:"patient",setup(m){const _=g([]),f=async()=>{const n=await X();_.value=n.data};H(()=>{f()});const h=g([{label:"男",value:1},{label:"女",value:2}]),i={name:"",idCard:"",gender:1,defaultFlag:0},r=g(!1),u=n=>{if(r.value=!0,n){const{id:t,gender:c,name:C,idCard:V,defaultFlag:k}=n;e.value={id:t,gender:c,name:C,idCard:V,defaultFlag:k}}else e.value={...i}},e=g({...i}),F=J({get(){return e.value.defaultFlag!==0},set(n){e.value.defaultFlag=n?1:0}}),$=()=>{r.value=!1},B=g(),L=async()=>{var t;await((t=B.value)==null?void 0:t.validate()),+e.value.idCard.slice(-2,-1)%2!==e.value.gender&&await I({title:"温馨提示",message:`填写的性别和身份证号中的不一致
您确认提交吗？`}),e.value.id?(await Y(e.value),y("编辑成功")):(await Z(e.value),y("添加成功")),f(),$()},z=async()=>{e.value.id&&(await I({title:"温馨提示",message:`您确认要删除 ${e.value.name} 患者信息吗 ？`}),await ee(e.value.id),r.value=!1,f(),y("删除成功"))};return(n,t)=>{const c=p("van-field"),C=p("van-checkbox"),V=p("van-form"),k=p("van-action-bar-button"),T=p("van-action-bar"),j=p("van-popup");return s(),d("div",se,[o(x,{title:"家庭档案"}),l("div",ne,[(s(!0),d(N,null,P(_.value,a=>(s(),d("div",{class:"patient-item",key:a.id},[l("div",de,[l("span",ie,b(a.name),1),l("span",ue,b(a.idCard.replace(/^(.{6}).+(.{4})$/,"$1********$2")),1),l("span",null,b(a.genderValue),1),l("span",null,b(a.age)+"岁",1)]),l("div",{class:"icon",onClick:_e=>u(a)},[o(M,{class:"cp-icon",name:"user-edit"})],8,re),a.defaultFlag===1?(s(),d("div",ce,"默认")):w("",!0)]))),128)),_.value.length<7?(s(),d("div",{key:0,class:"patient-add",onClick:t[0]||(t[0]=a=>u())},[o(M,{name:"user-add"}),pe])):w("",!0),ve]),o(j,{show:r.value,"onUpdate:show":t[5]||(t[5]=a=>r.value=a),position:"right"},{default:v(()=>[o(x,{title:e.value.id?"编辑患者":"添加患者",back:$,"right-text":"保存",onClickRight:L},null,8,["title"]),o(V,{autocomplete:"off",ref_key:"form",ref:B},{default:v(()=>[o(c,{modelValue:e.value.name,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value.name=a),label:"真实姓名",rules:S(q),placeholder:"请输入真实姓名"},null,8,["modelValue","rules"]),o(c,{modelValue:e.value.idCard,"onUpdate:modelValue":t[2]||(t[2]=a=>e.value.idCard=a),label:"身份证号",rules:S(A),placeholder:"请输入身份证号"},null,8,["modelValue","rules"]),o(c,{label:"性别",class:"pb4"},{input:v(()=>[o(le,{options:h.value,modelValue:e.value.gender,"onUpdate:modelValue":t[3]||(t[3]=a=>e.value.gender=a)},null,8,["options","modelValue"])]),_:1}),o(c,{label:"默认就诊人"},{input:v(()=>[o(C,{modelValue:F.value,"onUpdate:modelValue":t[4]||(t[4]=a=>F.value=a),"icon-size":18,round:""},null,8,["modelValue"])]),_:1})]),_:1},512),e.value.id?(s(),K(T,{key:0},{default:v(()=>[o(k,{onClick:z},{default:v(()=>[O("删除")]),_:1})]),_:1})):w("",!0)]),_:1},8,["show"])])}}}),ke=U(me,[["__scopeId","data-v-0fb565a1"]]);export{ke as default};
